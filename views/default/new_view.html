<!DOCTYPE html>
<html>
 <head>
  <!-- Standard Meta -->
  <meta charset="utf-8"/>
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0" name="viewport"/>
  <!-- Site Properties -->
  <title>
   Weathert Beta
  </title>
  <link href="{{=URL('static', 'Semantic-UI-CSS-master/semantic.min.css')}}/" rel="stylesheet" type="text/css"/>
  <link href="{{=URL('static', 'Semantic-UI-CSS-master/components/icon.css')}}/" rel="stylesheet" type="text/css"/>
  <link href="{{=URL('static/css', 'weathert.css')}}/" rel="stylesheet" type="text/css"/>
  <script src="{{=URL('static', 'js/jquery.js')}}/"></script>
  <script src="{{=URL('static', 'js/formatDate.js')}}"></script>
  <script src="{{=URL('static', 'Semantic-UI-CSS-master/components/visibility.js')}}/"></script>
  <script src="{{=URL('static', 'Semantic-UI-CSS-master/components/sidebar.js')}}/"></script>
  <script src="{{=URL('static', 'Semantic-UI-CSS-master/components/transition.js')}}/"></script>
  <script src="{{=URL('static', 'js/color_script.js')}}/"></script>
  <script>
    $(document).ready(function() {
        // fix menu when passed
        $('.masthead')
            .visibility({
                once: false,
                onBottomPassed: function() {
                    $('.fixed.menu').transition('fade in');
                },
                onBottomPassedReverse: function() {
                    $('.fixed.menu').transition('fade out');
                }
            });

        // create sidebar and attach to menu open
        $('.ui.sidebar')
            .sidebar('attach events', '.toc.item');


        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(fetchWeather, showError);
            } else {
                alert("Geolocation is not supported by this browser.");
            }
        }


        function showError(error) {
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    alert("User denied the request for Geolocation.");
                    break;
                case error.POSITION_UNAVAILABLE:
                    alert("Location information is unavailable.");
                    break;
                case error.TIMEOUT:
                    alert("The request to get user location timed out.");
                    break;
                case error.UNKNOWN_ERROR:
                    alert("An unknown error occurred.");
                    break;
            }
        }


        function fetchWeather(position) {
            $.ajax({
                url: "{{=URL('default', 'get_w')}}",
                data: {
                    lat: position.coords.latitude,
                    lon: position.coords.longitude
                },
                success: function(data) {
                    var currentWeather = data.current;

                    var formattedDate = formatEpochToReadableDate(currentWeather.dt);
                    $("#current_temp").html(currentWeather.temp + "&deg;");
                    $("#current_feels_like").html(currentWeather.feels_like + "&deg;");
                    $("#current_time").text(formattedDate);
                    $("#current_dew_point").text(currentWeather.dew_point);
                    $("#current_description").text(currentWeather.weather[0].description);
                    $("#current_humidity").text(currentWeather.humidity);
                }
            });
        }



        // Call the function immediately when the page loads
        getLocation();
        // Set the function to be called every 60000 milliseconds (1 minute)
        setInterval(getLocation, 60000);



    });

  </script>

 </head>
 <body>
  <!-- Following Menu -->
  <div class="ui large top fixed hidden menu">
   <div class="ui container">
    <a class="active item">
     Home
    </a>
    <a class="item">
     Work
    </a>
    <a class="item">
     Company
    </a>
    <a class="item">
     Careers
    </a>
    <div class="right menu">
     <div class="item">
      <a class="ui button">
       Log in
      </a>
     </div>
     <div class="item">
      <a class="ui primary button">
       Sign Up
      </a>
     </div>
    </div>
   </div>
  </div>
  <!-- Sidebar Menu -->
  <div class="ui vertical inverted sidebar menu">
   <a class="active item">
    Home
   </a>
   <a class="item">
    Work
   </a>
   <a class="item">
    Company
   </a>
   <a class="item">
    Careers
   </a>
   <a class="item">
    Login
   </a>
   <a class="item">
    Signup
   </a>
  </div>
  <!-- Page Contents -->
  <div class="pusher">
   <div class="ui inverted vertical masthead center aligned segment" id="color-changing-div">
    <div class="ui container">
     <div class="ui large secondary inverted pointing menu">
      <a class="toc item">
       <i class="sidebar icon">
       </i>
      </a>
      <a class="active item">
       Home
      </a>
      <a class="item">
       Work
      </a>
      <a class="item">
       Company
      </a>
      <a class="item">
       Careers
      </a>
      <div class="right item">
       <a class="ui inverted button">
        Log in
       </a>
       <a class="ui inverted button">
        Sign Up
       </a>
      </div>
     </div>
    </div>
    <div class="ui text container">
     <h1 class="ui inverted header">
      Weathert
      <i class="thermometer three quarters icon">
      </i>
     </h1>
     <h2>
      Get your live weather and receive email alerts!
     </h2>
     <div class="ui huge primary button">
      Get Started
      <i class="right arrow icon">
      </i>
     </div>
    </div>
   </div>
   <div class="ui statistics">
    <div class="ui large blue statistic">
     <div class="value" id="current_temp">
      -
     </div>
     <div class="label">
      Temp
     </div>
    </div>
    <div class="ui large pink statistic">
     <div class="value" id="current_feels_like">
      -
     </div>
     <div class="label">
      Feels Like
     </div>
    </div>
    <div class="ui large olive statistic">
     <div class="value" id="current_description">
      -
     </div>
     <div class="label">
      Description
     </div>
    </div>
    <div class="ui large green statistic">
     <div class="value" id="current_dew_point">
      -
     </div>
     <div class="label">
      Dew Point
     </div>
    </div>
    <div class="ui large orange statistic">
     <div class="value" id="current_humidity">
      -
     </div>
     <div class="label">
      Humidity
     </div>
    </div>
    <div class="ui large violet statistic">
     <div class="value" id="current_time">
      -
     </div>
     <div class="label">
      Time
     </div>
    </div>
   </div>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <br/>
   <div class="ui inverted vertical footer segment">
    <div class="ui container">
     <div class="seven wide column">
      <h4 class="ui inverted header">
       Weathert Beta
      </h4>
      <p>
       No Matter the Weather, Weathert Knows Whether You'll Need an Umbrella or Sunglasses!
      </p>
     </div>
    </div>
   </div>
  </div>
 </body>
</html>
